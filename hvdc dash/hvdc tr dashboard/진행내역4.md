P0 → P1 → P2 순서 권장. 이유와 구체 구현안 정리 중입니다.


[3 tools called]


# 진행 순서 확정

P0 → P1 → P2 순서를 권장합니다.

## 권장 진행 순서

### Phase 0: 데이터 로딩 연결 (안전한 기반)

이유:
- 기존 UI 동작 유지
- 데이터 파이프라인만 교체해 리스크 최소화
- 매퍼 검증 가능
- 다음 단계 기반 제공

---

## Phase 0 구현안: 데이터 로딩 연결

### 1. `lib/data/schedule-data.ts` 생성

```typescript
/**
 * Schedule Data Loader
 * 
 * option_c.json → ScheduleActivity[] 변환
 * 기존 ganttData와 호환 유지
 */

import { mapOptionCJsonToScheduleActivities } from "@/lib/utils/schedule-mapper"
import type { ScheduleActivity } from "@/lib/ssot/schedule"
import optionCDataRaw from "../../option_c.json"

/**
 * 변환된 ScheduleActivity 배열
 */
export const scheduleActivities: ScheduleActivity[] = 
  mapOptionCJsonToScheduleActivities(optionCDataRaw as { activities: any[] })

/**
 * 기존 ganttData 구조로 변환 (호환성 유지)
 * 
 * TODO: 향후 ganttData를 ScheduleActivity 기반으로 전환
 */
export function getGanttDataFromSchedule() {
  // 현재는 기존 ganttData를 그대로 반환
  // Phase 1에서 ScheduleActivity → GanttRow 변환 유틸 추가 예정
  return null // 임시
}
```

---

### 2. `gantt-chart.tsx` 수정 (읽기 전용 연결)

기존 렌더 유지, 데이터 로딩만 추가:

```typescript
"use client"

import React from "react"
import { useState, useEffect } from "react"
import { Calendar } from "lucide-react"
import {
  ganttData,
  legendItems,
  milestones,
  PROJECT_START,
  TOTAL_DAYS,
  type Activity,
  type ActivityType,
  activityTypeNames,
} from "@/lib/dashboard-data"
import { scheduleActivities } from "@/lib/data/schedule-data" // ← 추가
import { cn } from "@/lib/utils"

// ... (기존 코드 유지)

export function GanttChart() {
  const [tooltip, setTooltip] = useState<TooltipState>({
    visible: false,
    x: 0,
    y: 0,
    activity: null,
  })

  // 데이터 로딩 확인 (개발 모드에서만)
  useEffect(() => {
    if (process.env.NODE_ENV === 'development') {
      console.log('[Gantt] Loaded schedule activities:', scheduleActivities.length)
      console.log('[Gantt] Sample activities:', scheduleActivities.slice(0, 3))
    }
  }, [])

  // ... (기존 렌더 코드 그대로 유지)

  return (
    <section className="bg-card/85 backdrop-blur-lg rounded-2xl p-6 border border-accent/15 mb-6">
      {/* ... 기존 렌더 코드 ... */}
    </section>
  )
}
```

---

### 3. 타입 체크 및 검증

```bash
# 타입 체크 실행
pnpm run typecheck

# 예상 확인 사항:
# - option_c.json import 경로 확인
# - scheduleActivities 타입 일치
# - 기존 ganttData 사용에 영향 없음
```

---

## Phase 0 체크리스트

| 작업 | 파일 | 상태 | 검증 |
|------|------|------|------|
| 1. 데이터 로더 생성 | `lib/data/schedule-data.ts` | ⏳ | option_c.json 로드 확인 |
| 2. Gantt 차트 연결 | `gantt-chart.tsx` | ⏳ | 기존 렌더 유지 확인 |
| 3. 타입 체크 | - | ⏳ | `pnpm run typecheck` |
| 4. 빌드 테스트 | - | ⏳ | `pnpm run build` |

---

## 다음 Phase 미리보기

### Phase 1: Preview 패널 (P1)

```typescript
// components/gantt/SchedulePreviewPanel.tsx
// - 변경 사항 목록 표시
// - 충돌 경고 표시
// - 적용/취소 버튼
```

### Phase 2: 편집 UI 연결 (P2)

```typescript
// gantt-chart.tsx에 통합
// - 활동 바 드래그/더블클릭
// - reflowSchedule 호출
// - Preview 패널 표시
```

---

## 주의사항

### option_c.json import 경로

Next.js에서 JSON import 시 경로 확인:

```typescript
// 옵션 1: 루트에 있는 경우
import optionCDataRaw from "../../option_c.json"

// 옵션 2: public/에 있는 경우 (런타임 fetch)
// const optionCDataRaw = await fetch("/option_c.json").then(r => r.json())
```

현재 `option_c.json`이 루트에 있으므로 옵션 1 사용.

---

## Phase 0 실행 계획

1. `lib/data/` 디렉토리 생성 (없는 경우)
2. `schedule-data.ts` 파일 생성
3. `gantt-chart.tsx`에 읽기 전용 연결 추가
4. 타입 체크 실행
5. 빌드 테스트

이 순서로 진행할까요? Agent 모드로 전환하시면 파일 생성 및 수정을 진행하겠습니다.